<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Drag and Drop</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<OBJECT TYPE="application/x-oleobject" CLASSID="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
	<PARAM NAME="Keyword" VALUE="drag and drop">
	<PARAM NAME="Keyword" VALUE="file">
	<PARAM NAME="Keyword" VALUE="drop">
</OBJECT>

<H2><A NAME="draganddrop"></A>Drag and Drop</H2>

<P>Under MS-Windows 3.1 and above, MicroEMACS supports a "drag and drop" file-selection mechanism. If you select one or more files in the Windows File Manager and drag them with the mouse, dropping them over MicroEMACS generates a pseudo mouse action: <A HREF="glos3hgu.htm">MS!</A> that can be used by <A HREF="glos21rb.htm">binding</A> it to a <A HREF="glos9lnz.htm">macro</A>.</P>

<P>For instance, the following command causes a macro named "drop-files" to be invoked every time a group of files is dropped on MicroEMACS:</P>

<P>macro-to-key  drop-files  MS!</P>

<P>The macro that handles the drag and drop mechanism acquires the necessary information from a buffer named "<B>Dropped files</B>":</P>

<P>The first line of that buffer contains the name of the <A HREF="glos0wxa.htm">screen</A> on which the drop occurred. It is empty if the files were not dropped on any specific screen (for instance if they were dropped on the <A HREF="glos91id.htm">message line</A>).</P>

<P>The second and following lines contain the list of dropped files, one pathname per line.</P>

<P>In addition, the <A HREF="macr5nhv.htm">$xpos</A> and <A HREF="macr19rn.htm">$ypos</A> <A HREF="glos7v51.htm">variables</A> are set to the text coordinates where the drop occurred (or to the value 255 if the files were not dropped on any specific screen).</P>

<P>The <A HREF="help5qck.htm">MDI.CMD</A> <A HREF="glos7y5h.htm">page</A> contains a sample macro that handles drag and drop.</P>

</BODY>
</HTML>
